(function(l){if(!("EventSource"in l)||$.browser.mozilla){var m=function(a){function d(a){b._pollTimer=setTimeout(function(){c.call(b)},a)}function c(){try{if(b.readyState!=b.CLOSED){var a=new XMLHttpRequest;a.open("GET",b.URL,!0);a.setRequestHeader("Accept","text/event-stream");a.setRequestHeader("Cache-Control","no-cache");a.setRequestHeader("X-Requested-With","XMLHttpRequest");null!=h&&a.setRequestHeader("Last-Event-ID",h);a.timeout=5E4;a.onreadystatechange=function(){if(3==this.readyState||4==
this.readyState&&200==this.status){b.readyState==b.CONNECTING&&(b.readyState=b.OPEN,b.dispatchEvent("open",{type:"open"}));var a="";try{a=this.responseText||""}catch(c){}var e=$.parseJSON(a),a="message",g,f;e.retry&&(f=e.retry);e.event&&(a=e.event);e.id&&(h=e.id);e.data&&(g=e.data);$.isNumeric(f)&&0<f&&(k=f);g&&(g=new n(JSON.stringify(g),b.url,h),b.dispatchEvent(a,g));4==this.readyState&&$.isNumeric(f)&&0<f&&d(k)}else b.readyState!==b.CLOSED&&(4==this.readyState?(b.readyState=b.CONNECTING,b.dispatchEvent("error",
{type:"error"}),d(k)):0==this.readyState&&d(k))};a.send();setTimeout(function(){a.abort()},a.timeout);b._xhr=a}}catch(c){b.dispatchEvent("error",{type:"error",data:c.message})}}var b=this,k=500,h=null;if(!a||"string"!=typeof a)throw new SyntaxError("Not enough arguments");this.URL=a+"&manual=true";this.readyState=this.CONNECTING;this._xhr=this._pollTimer=null;c()};m.prototype={close:function(){this.readyState=this.CLOSED;clearInterval(this._pollTimer);this._xhr.abort()},CONNECTING:0,OPEN:1,CLOSED:2,
dispatchEvent:function(a,d){var c=this["_"+a+"Handlers"];if(c)for(var b=0;b<c.length;b++)c[b].call(this,d);this["on"+a]&&this["on"+a].call(this,d)},addEventListener:function(a,d){this["_"+a+"Handlers"]||(this["_"+a+"Handlers"]=[]);this["_"+a+"Handlers"].push(d)},removeEventListener:function(a,d){var c=this["_"+a+"Handlers"];if(c)for(var b=c.length-1;0<=b;--b)if(c[b]===d){c.splice(b,1);break}},onerror:null,onmessage:null,onopen:null,readyState:0,URL:""};var n=function(a,d,c){this.data=a;this.origin=
d;this.lastEventId=c||""};n.prototype={data:null,type:"message",lastEventId:"",origin:""};"module"in l&&(module.exports=m);l.EventSource=m}})(this);