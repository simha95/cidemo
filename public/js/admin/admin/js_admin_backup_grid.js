Project.modules.backup={init:function(){},showFullBackupListing:function(){var c=this,d=[],f=!0,g=!0,b=el_tpl_settings.main_grid_id,h=el_tpl_settings.main_pager_id,e;for(e in js_col_name_json)d.push(js_col_name_json[e].label);e=$("#main_content_div").width()-30;getColumnsWidth(el_grid_settings.enc_location+"_cw",b,js_col_model_json);jQuery("#list2").jqGrid({editurl:el_grid_settings.delete_url,data:js_data_json,datatype:"local",colNames:d,colModel:js_col_model_json,rowNum:el_tpl_settings.grid_rec_limit,
pgnumbers:el_theme_settings.grid_pgnumbers?!0:!1,pgnumlimit:parseInt(el_theme_settings.grid_pgnumlimit),pagingpos:el_theme_settings.grid_pagingpos,rowList:[10,20,30,50,100,200,500],sortname:el_grid_settings.default_sort,sortorder:el_grid_settings.sort_order,altRows:!0,altclass:"evenRow",multiselectWidth:30,viewrecords:!0,multiselect:!0,multiboxonly:!0,caption:!1,hidegrid:!1,pager:"Y"==el_tpl_settings.grid_bot_menu?"#pager2":"",toppager:"Y"==el_tpl_settings.grid_top_menu?!0:!1,toppaging:"Y"==el_tpl_settings.grid_top_menu?
!0:!1,sortable:{update:function(a){setColumnsPosition(el_grid_settings.enc_location+"_cp",a,b,js_col_model_json)}},searchGrid:{multipleSearch:!0},forceApply:!0,forceWidth:e,width:e,height:400,autowidth:!0,shrinkToFit:800,fixed:!0,grouping:!0,groupingView:{groupField:["month"],groupOrder:["desc"],groupText:["<b>{0}</b>"],groupColumnShow:[!1],groupSummary:[!0],showSummaryOnHide:!0,groupCollapse:!1,groupDataSorted:!0},beforeRequest:function(){getColumnsPosition(el_grid_settings.enc_location+"_cp",b)},
loadComplete:function(a){$("#"+b+"_messages_html").remove();$("#selAllRows").val("false");g?g=!1:(resizeGridWidth(),checkColumnsWidth(el_grid_settings.enc_location+"_cw",b))},gridComplete:function(){$(".ui-jqgrid-sortable").mousedown(function(){$(this).css("cursor","crosshair")});$(".ui-jqgrid-sortable").mouseup(function(){$(this).css({cursor:"pointer"})});f?f=!1:resizeGridWidth()},onSortCol:function(a,b,c){},resizeStop:function(a,c){setColumnsWidth(el_grid_settings.enc_location+"_cw",b)},beforeSelectRow:function(a,
b){multiSelectHandler(a,b)}});jQuery("#"+b).jqGrid("navGrid","#"+h,{cloneToTop:!0,add:!1,edit:!1,search:!1,del:"1"==el_grid_settings.permit_del_btn?!0:!1,delicon_p:el_theme_settings.grid_icons.del?"uigrid-del-btn del-icon-only":"uigrid-del-btn",deltext:el_theme_settings.grid_icons.del?"":js_lang_label.GENERIC_GRID_DELETE,alerttext:js_lang_label.GENERIC_PLEASE_SELECT_ANY_RECORD,refreshicon_p:el_theme_settings.grid_icons.refresh?"uigrid-refresh-btn refresh-icon-only":"uigrid-refresh-btn",refreshtext:el_theme_settings.grid_icons.refresh?
"":js_lang_label.GENERIC_GRID_SHOW_ALL,refreshtitle:js_lang_label.GENERIC_REFRESH_LISTING,afterRefresh:function(){$(".search-chosen-select").find("option").removeAttr("selected");$(".search-chosen-select").trigger("chosen:updated")}},{},{},{width:350,caption:js_lang_label.GENERIC_GRID_DELETE,msg:js_lang_label.GENERIC_ARE_YOU_SURE_WANT_TO_DELETE_SELECTED_RECORDS,bSubmit:js_lang_label.GENERIC_GRID_DELETE,bCancel:js_lang_label.GENERIC_CANCEL,modal:!0,closeOnEscape:!0},{});"1"==el_grid_settings.permit_add_btn&&
(jQuery("#"+b).navButtonAdd("#"+h,{caption:el_theme_settings.grid_icons.add?"":js_lang_label.GENERIC_CREATE_BACKUP,title:js_lang_label.GENERIC_CREATE_BACKUP,buttonicon:"ui-icon-plus",buttonicon_p:el_theme_settings.grid_icons.add?"uigrid-add-btn add-icon-only":"uigrid-add-btn",onClickButton:function(){c.createNewBackup()},position:"first"}),jQuery("#"+b).navButtonAdd("#"+b+"_toppager_left",{caption:el_theme_settings.grid_icons.add?"":js_lang_label.GENERIC_CREATE_BACKUP,title:js_lang_label.GENERIC_CREATE_BACKUP,
buttonicon:"ui-icon-plus",buttonicon_p:el_theme_settings.grid_icons.add?"uigrid-add-btn add-icon-only":"uigrid-add-btn",onClickButton:function(){c.createNewBackup()},position:"first"}));jQuery("#"+b).navButtonAdd("#"+h,{caption:el_theme_settings.grid_icons.columns?"":js_lang_label.GENERIC_GRID_COLUMNS,title:js_lang_label.GENERIC_GRID_HIDESHOW_COLUMNS,buttonicon:"ui-icon-columns",buttonicon_p:el_theme_settings.grid_icons.columns?"uigrid-col-btn col-icon-only":"uigrid-col-btn",onClickButton:function(){jQuery("#"+
b).jqGrid("columnChooser",{classname:"grid-columns-picker",msel_opts:{autoOpen:!0,beforeopen:function(a,b){applyUIButtonCSS()}},beforeSubmit:function(a){if(null!=$("#"+a).find("select").val())return!0;jQuery.jgrid.info_dialog(js_lang_label.GENERIC_GRID_ERROR,js_lang_label.GENERIC_GRID_PLEASE_SELECT_ATLEAST_ONE_COLUMN,js_lang_label.GENERIC_GRID_OK);return!1},done:function(a){$("#"+b).trigger("reloadGrid")}})},position:"last"});jQuery("#"+b).navButtonAdd("#"+b+"_toppager_left",{caption:el_theme_settings.grid_icons.columns?
"":js_lang_label.GENERIC_GRID_COLUMNS,title:js_lang_label.GENERIC_GRID_HIDESHOW_COLUMNS,buttonicon:"ui-icon-columns",buttonicon_p:el_theme_settings.grid_icons.columns?"uigrid-col-btn col-icon-only":"uigrid-col-btn",onClickButton:function(){jQuery("#"+b).jqGrid("columnChooser",{classname:"grid-columns-picker",msel_opts:{autoOpen:!0,beforeopen:function(a,b){applyUIButtonCSS()}},beforeSubmit:function(a){if(null!=$("#"+a).find("select").val())return!0;jQuery.jgrid.info_dialog(js_lang_label.GENERIC_GRID_ERROR,
js_lang_label.GENERIC_GRID_PLEASE_SELECT_ATLEAST_ONE_COLUMN,js_lang_label.GENERIC_GRID_OK);return!1},done:function(a){$("#"+b).trigger("reloadGrid")}})},position:"last"});var k=$.jgrid.viewModal;$.extend($.jgrid,{viewModal:function(a,b){if(a=="#searchmodfbox_"+b.gid||"#alertmod"==a||a=="#delmod"+b.gid||"#info_dialog"==a){var c=jQuery("#gbox_"+el_tpl_settings.main_grid_id).offset();jQuery("#gbox_"+el_tpl_settings.main_grid_id).width();var d=jQuery("#gbox_"+el_tpl_settings.main_grid_id).height(),g=
$(a).width(),e=$(a).height();$(a).css({top:c.top+(d-e)/2-40,left:"calc(50% - "+g/2+"px)"})}k.call(this,a,b)}});var l=$.jgrid.info_dialog;$.extend($.jgrid,{info_dialog:function(a,b,c,d){return l.call(this,a,b,c,d)}})},showTableBackupListing:function(){var c=this,d=[],f=!0,g=!0,b=el_tpl_settings.main_grid_id,h=el_tpl_settings.main_pager_id,e;for(e in js_col_name_json)d.push(js_col_name_json[e].label);e=$("#main_content_div").width()-30;getColumnsWidth(el_grid_settings.enc_location+"_cw",b,js_col_model_json);
jQuery("#list2").jqGrid({editurl:el_grid_settings.delete_url,data:js_data_json,datatype:"local",colNames:d,colModel:js_col_model_json,rowNum:el_tpl_settings.grid_rec_limit,pgnumbers:el_theme_settings.grid_pgnumbers?!0:!1,pgnumlimit:parseInt(el_theme_settings.grid_pgnumlimit),pagingpos:el_theme_settings.grid_pagingpos,rowList:[10,20,30,50,100,200,500],sortname:el_grid_settings.default_sort,sortorder:el_grid_settings.sort_order,altRows:!0,altclass:"evenRow",multiselectWidth:30,viewrecords:!0,multiselect:!0,
multiboxonly:!0,caption:!1,hidegrid:!1,pager:"Y"==el_tpl_settings.grid_bot_menu?"#pager2":"",toppager:"Y"==el_tpl_settings.grid_top_menu?!0:!1,toppaging:"Y"==el_tpl_settings.grid_top_menu?!0:!1,sortable:{update:function(a){setColumnsPosition(el_grid_settings.enc_location+"_cp",a,b,js_col_model_json)}},searchGrid:{multipleSearch:!0},forceApply:!0,forceWidth:e,width:e,height:400,autowidth:!0,shrinkToFit:800,fixed:!0,grouping:!1,beforeRequest:function(){getColumnsPosition(el_grid_settings.enc_location+
"_cp",b)},loadComplete:function(a){$("#"+b+"_messages_html").remove();$("#selAllRows").val("false");g?g=!1:(resizeGridWidth(),checkColumnsWidth(el_grid_settings.enc_location+"_cw",b))},gridComplete:function(){$(".ui-jqgrid-sortable").mousedown(function(){$(this).css("cursor","crosshair")});$(".ui-jqgrid-sortable").mouseup(function(){$(this).css({cursor:"pointer"})});f?f=!1:resizeGridWidth()},onSortCol:function(a,b,c){},resizeStop:function(a,c){setColumnsWidth(el_grid_settings.enc_location+"_cw",b)},
beforeSelectRow:function(a,b){multiSelectHandler(a,b)}});jQuery("#"+b).jqGrid("filterToolbar",{stringResult:!0,searchOnEnter:!1,searchOperators:el_theme_settings.grid_searchopt?!0:!1,operandTitle:js_lang_label.GENERIC_CLICK_TO_SELECT_SEARCH_OPERATION,clearTitle:js_lang_label.GENERIC_CLEAR_SEARCH_VALUE});jQuery("#"+b).jqGrid("navGrid","#"+h,{cloneToTop:!0,add:!1,edit:!1,search:!1,del:!1,alerttext:js_lang_label.GENERIC_PLEASE_SELECT_ANY_RECORD,refreshicon_p:el_theme_settings.grid_icons.refresh?"uigrid-refresh-btn refresh-icon-only":
"uigrid-refresh-btn",refreshtext:el_theme_settings.grid_icons.refresh?"":js_lang_label.GENERIC_GRID_SHOW_ALL,refreshtitle:js_lang_label.GENERIC_REFRESH_LISTING,afterRefresh:function(){$(".search-chosen-select").find("option").removeAttr("selected");$(".search-chosen-select").trigger("chosen:updated")}},{},{},{width:350,caption:js_lang_label.GENERIC_GRID_DELETE,msg:js_lang_label.GENERIC_ARE_YOU_SURE_WANT_TO_DELETE_SELECTED_RECORDS,bSubmit:js_lang_label.GENERIC_GRID_DELETE,bCancel:js_lang_label.GENERIC_CANCEL,
modal:!0,closeOnEscape:!0},{});"1"==el_grid_settings.permit_add_btn&&(jQuery("#"+b).navButtonAdd("#"+h,{caption:el_theme_settings.grid_icons.add?"":js_lang_label.GENERIC_CREATE_BACKUP,title:js_lang_label.GENERIC_CREATE_BACKUP,buttonicon:"ui-icon-plus",buttonicon_p:el_theme_settings.grid_icons.add?"uigrid-add-btn add-icon-only":"uigrid-add-btn",onClickButton:function(){var a=$(this).getGridParam("selarrrow");a&&0!=a.length?(a=a.join(","),c.createTableBackup(a,"backup_table")):jqueryUIdialogBox("<div></div>",
js_lang_label.GENERIC_PLEASE_SELECT_ANY_RECORD_TO_TAKE_BACKUP,{title:"Backup",buttons:[{text:js_lang_label.GENERIC_BACKUP,bt_type:"backup",click:function(){$(this).remove()}}]})},position:"first"}),jQuery("#"+b).navButtonAdd("#"+b+"_toppager_left",{caption:el_theme_settings.grid_icons.add?"":js_lang_label.GENERIC_CREATE_BACKUP,title:js_lang_label.GENERIC_CREATE_BACKUP,buttonicon:"ui-icon-plus",buttonicon_p:el_theme_settings.grid_icons.add?"uigrid-add-btn add-icon-only":"uigrid-add-btn",onClickButton:function(){var a=
$(this).getGridParam("selarrrow");a&&0!=a.length?(a=a.join(","),c.createTableBackup(a,"backup_table")):jqueryUIdialogBox("<div></div>",js_lang_label.GENERIC_PLEASE_SELECT_ANY_RECORD_TO_TAKE_BACKUP,{title:"Backup",buttons:[{text:js_lang_label.GENERIC_BACKUP,bt_type:"backup",click:function(){$(this).remove()}}]})},position:"first",id:"btn_top_backup"}));jQuery("#"+b).navButtonAdd("#"+h,{caption:el_theme_settings.grid_icons["export"]?"":js_lang_label.GENERIC_BACKUP_AND_DOWNLOAD,title:js_lang_label.GENERIC_BACKUP_AND_DOWNLOAD,
buttonicon:"ui-icon-export",buttonicon_p:el_theme_settings.grid_icons["export"]?"uigrid-export-btn export-icon-only":"uigrid-export-btn",onClickButton:function(){var a=$(this).getGridParam("selarrrow");a&&0!=a.length?(a=a.join(","),c.createTableBackup(a,"backup_download")):jqueryUIdialogBox("<div></div>",js_lang_label.GENERIC_PLEASE_SELECT_ANY_RECORD_TO_BACKUP_AND_DOWNLOAD,{title:"Backup",buttons:[{text:js_lang_label.GENERIC_BACKUP,bt_type:"backup",click:function(){$(this).remove()}}]})},position:"last",
id:"btn_bot_download",afterButtonId:"btn_bot_backup"});jQuery("#"+b).navButtonAdd("#"+b+"_toppager_left",{caption:el_theme_settings.grid_icons["export"]?"":js_lang_label.GENERIC_BACKUP_AND_DOWNLOAD,title:js_lang_label.GENERIC_BACKUP_AND_DOWNLOAD,buttonicon:"ui-icon-export",buttonicon_p:el_theme_settings.grid_icons["export"]?"uigrid-export-btn export-icon-only":"uigrid-export-btn",onClickButton:function(){var a=$(this).getGridParam("selarrrow");a&&0!=a.length?(a=a.join(","),c.createTableBackup(a,"backup_download")):
jqueryUIdialogBox("<div></div>",js_lang_label.GENERIC_PLEASE_SELECT_ANY_RECORD_TO_BACKUP_AND_DOWNLOAD,{title:"Backup",buttons:[{text:js_lang_label.GENERIC_BACKUP,bt_type:"backup",click:function(){$(this).remove()}}]})},position:"last",id:"btn_top_download",afterButtonId:"btn_top_backup"});var k=$.jgrid.viewModal;$.extend($.jgrid,{viewModal:function(a,b){if(a=="#searchmodfbox_"+b.gid||"#alertmod"==a||a=="#delmod"+b.gid||"#info_dialog"==a){var c=jQuery("#gbox_"+el_tpl_settings.main_grid_id).offset();
jQuery("#gbox_"+el_tpl_settings.main_grid_id).width();var d=jQuery("#gbox_"+el_tpl_settings.main_grid_id).height(),g=$(a).width(),e=$(a).height();$(a).css({top:c.top+(d-e)/2-40,left:"calc(50% - "+g/2+"px)"})}k.call(this,a,b)}});var l=$.jgrid.info_dialog;$.extend($.jgrid,{info_dialog:function(a,b,c,d){return l.call(this,a,b,c,d)}})},createNewBackup:function(){$("#btype").val("full");var c={url:el_grid_settings.save_url,beforeSubmit:showAdminAjaxRequest,success:function(c,f,g,b){c=$.parseJSON(c);responseAjaxDataSubmission(c);
if("0"==c.success)return!1;""!=c.return_url&&(window.location.hash=c.return_url)}};$("#frmbackupsave").ajaxSubmit(c);return!1},createTableBackup:function(c,d){$("#id_arr").val(c);$("#btype").val(d);if("backup_download"==d)$("#frmbackupsave").submit();else if("backup_table"==d){var f={url:el_grid_settings.save_url,beforeSubmit:showAdminAjaxRequest,success:function(c,b,d,e){c=$.parseJSON(c);responseAjaxDataSubmission(c);if("0"==c.success)return!1;""!=c.return_url&&(window.location.hash=c.return_url)}};
$("#frmbackupsave").ajaxSubmit(f);return!1}},downloadDBBackupFile:function(c){$("#fname").val(c);$("#frmbackupdwnd").submit()}};function formatBackupFileSize(c,d,f){return c+" KB"}
function formatBackupDownloadLink(c,d,f){"1"==el_grid_settings.permit_view_btn?(c="<a href='javascript://' title='"+js_lang_label.GENERIC_DOWNLOAD_FILE+"' onclick='Project.modules.backup.downloadDBBackupFile(\""+c+"\");return false;'>",c+="<span class='icon16 entypo-icon-download'></span></a>"):c='<div class="errormsg"> N/A </div>';return c}Project.modules.backup.init();