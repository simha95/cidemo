(function(a){var w=function(a,d){var k=this.slice((d||a)+1||this.length);this.length=0>a?this.length+a:a;return this.push.apply(this,k)};a.fn.ajaxChosen=function(c,d,k){var e=a(this),h,q,n,u,r,m=!1,l=[],t=!1,p="loading.gif";0===a("option",e).length&&e.append('<option value=""></option>');k?e.chosen(k):e.chosen();h=e.next();n=a("input",h);u=n.get(0)?n.get(0).style.background:"";"success"in c&&a.isFunction(c.success)&&(r=c.success);c.success=function(b,c,g){var f=b,k,m=l.length,p=!1,v=!1;if(t)return l.shift(),
!1;if(1<m){if(a.each(l,function(a,c){if(b.q===c)return a!==m-1?(p=!0,w.call(l,a)):(v=!0,l.length=0),!1}),p||!v)return!1}else if("undefined"===typeof l.shift())return!1;if("processItems"in d&&a.isFunction(d.processItems))f=d.processItems(b);else if("results"in f)f=f.results;else return console.log("Expected results key in data, but was not found. Options could not be built"),!1;k=a("option:selected",e).not(":empty").clone().attr("selected",!0);a("option",e).remove();a('<option value=""/>').appendTo(e);
h.hasClass("chosen-container-multi")&&k.appendTo(e);a.isArray(f)?a.each(f,function(b,c){var d;if(c.group)return d=e.find("optgroup[label='"+c.text+"']"),d.size()||(d=a("<optgroup />")),d.attr("label",c.text).appendTo(e),a.each(c.items,function(b,c){a('<option value="'+c.id+'">'+c.text+"</option>").appendTo(d)});a('<option value="'+c.id+'">'+c.text+"</option>").appendTo(e)}):a.each(f,function(b,c){a('<option value="'+b+'">'+c+"</option>").appendTo(e)});e.trigger("chosen:updated");q=a.Event("keyup");
q.which=39;n.val(b.q).trigger(q).get(0).style.background=u;a("> a span",h).text(e.attr("placeholder")||e.attr("data-placeholder")||"");0<f.length?a(".no-results",h).hide():a(".no-results",h).show();r&&r(b,c,g)};d||(d={});"loadingImg"in d&&(p=d.loadingImg);a(".chosen-search > input, .chosen-choices .search-field input",h).bind("keyup",function(b){var e=a(this),g=e.val(),f=e.attr("prevVal");if(9===b.which||13===b.which||16===b.which||17===b.which||18===b.which||19===b.which||20===b.which||27===b.which||
33===b.which||34===b.which||35===b.which||36===b.which||37===b.which||38===b.which||39===b.which||40===b.which||44===b.which||45===b.which||144===b.which||145===b.which||91===b.which||93===b.which||224===b.which||112<=b.which&&123>=b.which||g==f)return!1;e.attr("prevVal",g);if("useAjax"in d&&a.isFunction(d.useAjax)&&!d.useAjax(b)||0===a.trim(g).length)return!1;t=!0;a(".no-results",h).hide();a.isArray(c.data)?("q"===c.data[c.data.length-1].name&&c.data.pop(),c.data=c.data.concat({name:"q",value:g})):
("data"in c||(c.data={}),a.extend(c.data,{data:{q:g}}));"generateUrl"in d&&a.isFunction(d.generateUrl)&&(c.url=d.generateUrl(g));n.get(0).style.background='transparent url("'+p+'") no-repeat right 3px';m&&clearTimeout(m);m=setTimeout(function(){l.push(g);t=!1;a.ajax(c)},700)});return e}})(jQuery);